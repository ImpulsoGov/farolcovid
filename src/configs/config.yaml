refresh_rate: 999999 # minutes

br:
    api:
        external: http://datasource.coronacidades.org/
        local: http://45.55.43.231:7000/
        endpoints:
            simulacovid: "br/cities/simulacovid/main"
            rt:
                city: "br/cities/rt"
                health_region: "br/health_region/rt"
                state: "br/states/rt"
            farolcovid: 
                city: "br/cities/farolcovid/main"
                health_region: "br/health_region/farolcovid/main"
                state: "br/states/farolcovid/main"
            analysis:
                cases: "br/cities/cases/full"
                owid: "world/owid/heatmap"
            safereopen:
                economic_data: 
                    state: "br/states/safereopen/main"
                    health_region: "br/health_region/safereopen/main"
                cnae_sectors: "br/cnae/sectors"
    drive_paths:
        br_id_state_region_city: https://docs.google.com/spreadsheets/d/1pHkH9FZj-c_bCEdvCH9k54uog5QDEd_x5xi4YmDsqyY/edit#gid=565746364
        cities_population: https://docs.google.com/spreadsheets/d/1k8mXuUggBuBEghHhhLrLtA-5wa4JsAc-D35S5bNlf24
        health_infrastructure: https://docs.google.com/spreadsheets/d/1Zz5WqIj6-oO4skuHPkq3-W9VZxe-XMPThtI-vUghkFI
        embaixadores: https://docs.google.com/spreadsheets/d/1CASa-MdJS_o2tffWlIS--FSskSxhJUw3pA1L5AGIe04
        CNAE_sectors: https://docs.google.com/spreadsheets/d/1pP8dY9kRa9EvX3KcVPfMWJ8exDaoT1_bBggSKfD3y0k
        br_states_reopening_data: https://docs.google.com/spreadsheets/d/1-uU-CbE8k7ctRD-n8veEz0l--_ECcUyaa6ZcjhraO_o
        br_health_region_reopening_data: https://docs.google.com/spreadsheets/d/17FzeuXoHD5e9cqOHD1lcwyH7AgWTZ0UQ-7gwgA7VMok
    cases:
        url: https://data.brasil.io/dataset/covid19/caso_full.csv.gz
        rename:
            city_ibge_code: 'city_id'
            city: 'city_name'
            state: 'state_id'
            date: 'last_updated'
            last_available_deaths: 'deaths'
            last_available_confirmed: 'confirmed_cases'
            new_confirmed: 'daily_cases'
            daily_cases_sum: 'infectious_period_cases'
        drop: [
            'estimated_population_2019',
            'is_last',
            'is_repeated',
            'last_available_confirmed_per_100k_inhabitants',
            'last_available_date',
            'last_available_death_rate',
            'new_deaths',
            'place_type',
            # 'state'
        ]
        notification_window_days: 7
    cnes:
        source: 'DataSUS'
    farolcovid:
        simulacovid:
            columns: [
                "state_num_id",
                "state_id",
                "state_name",
                "health_region_id",
                "health_region_name",
                "city_id",
                "city_name",
                "population",
                "last_updated_number_beds",
                "author_number_beds",
                "number_beds",
                "last_updated_number_ventilators",
                "author_number_ventilators",
                "number_ventilators",
                "confirmed_cases",
                "active_cases",
                "deaths",
                "notification_rate",
                "state_notification_rate"
            ]   
            state_agg: {
                "population": sum,
                "confirmed_cases": sum,
                "active_cases": sum,
                "deaths": sum,
                "state_notification_rate": max,
                "number_beds": sum,
                "number_ventilators": sum
            }   
            health_region_agg: {
                "population": sum,
                "confirmed_cases": sum,
                "active_cases": sum,
                "deaths": sum,
                "notification_rate": median,
                "number_beds": sum,
                "number_ventilators": sum
            }  
        rules:
            rt_classification:
                column_name: 'rt_10days_ago_most_likely'
                cuts: [0, 1, 1.2, 10]
                categories: ['bom', 'insatisfatório', 'ruim'] # [1, 0, -1]

            rt_growth:
                column_name: "rt_ratio_week_avg"
                cuts: [0, 0.9, 1.1, 1000]
                categories: ['melhorando', 'estabilizando', 'piorando'] # [1, 0, -1]

            dday_classification:
                column_name: 'dday_beds_best'
                cuts: [0, 30, 60, 91.001]
                categories: ['ruim', 'insatisfatório', 'bom'] # [-1, 0, 1]

            subnotification_classification:
                column_name: 'subnotification_rate'
                cuts: [0, 0.5, 0.7, 1.001]
                categories: ['bom', 'insatisfatório', 'ruim']  # [1, 0, -1]

            inloco_growth:
                column_name: 'inloco_ratio_week_avgs'
                cuts: [0, 0.9, 1.1, 1000]
                categories: ['piorando', 'estabilizando', 'melhorando'] # [-1, 0, 1]       
        alerts:
            alto: 
                conditions: {
                    rt_classification: "ruim",
                    rt_growth: "piorando",
                    dday_classification: "ruim",
                    subnotification_classification: "ruim"
                }
                how: "any"
            medio: 
                conditions: {
                    rt_classification: "insatisfatório",
                    rt_growth: "melhorando|estabilizando",
                    dday_classification: "bom|insatisfatório",
                    subnotification_classification: "bom|insatisfatório"  
                }
                how: "all"
            medio2: 
                conditions: {
                    rt_classification: "bom|insatisfatório",
                    rt_growth: "melhorando|estabilizando",
                    dday_classification: "bom|insatisfatório",
                    subnotification_classification: "insatisfatório"  
                }
                how: "all"
            baixo:
                conditions: {
                    rt_classification: "bom",
                    rt_growth: "melhorando|estabilizando",
                    dday_classification: "bom|insatisfatório",
                    subnotification_classification: "bom"            
                }
                how: "all"
    indicators:
        rt:
            risk: "rt_classification"
            right_display: "rt_growth"
            left_display: ["rt_17days_ago_low", "rt_17days_ago_high"]
            display: ["rt_10days_ago_low", "rt_10days_ago_high"]
        subnotification_rate:
            risk: "subnotification_classification"
            right_display: "subnotification_rank"
            left_display: "confirmed_cases"
            display: "notification_rate"
        hospital_capacity:
            risk: "dday_classification"
            right_display: "number_ventilators"
            left_display: "number_beds"
            display: "dday_beds_best_months"
        social_isolation:
            risk: "Fonte: inloco"
            right_display: "inloco_growth"
            left_display: "inloco_last_week_7days_avg"
            display: "inloco_today_7days_avg"
    inloco:
        replace: 
            "São Valério da Natividade":
                "state_name": "Tocantins"
                "correct_name": "São Valério"
            "Campo Grande":
                "state_name": "Rio Grande do Norte"
                "correct_name": "Augusto Severo (Campo Grande)"
            "Boa Saúde":
                "state_name": "Rio Grande do Norte"
                "correct_name": "Boa Saúde (Januário Cicco)"
    rt_parameters:
        r_t_range_max: 12
        optimal_sigma: 0.01 # best sigma for Brazil (prior hyperparameters)
        window_size: 7
        gaussian_kernel_std: 2
        gaussian_min_periods: 7
        gamma_alpha: 4
        min_days: 14
    safereopen:
        rename:
            uf: "state_num_id"
            emprego: "n_employee"
            security_1: "security_index"
            massa_salarial: "total_wage_bill"
            ln_massa_salarial: "ln_total_wage_bill"
            sections: "sector"
    seir_parameters:
        # => new values:
        mild_duration: 6 # time from symptoms to hospitalization
        severe_duration: 6 # time from symptoms to ICU admit (12) - time from symptoms to hospitalization
        critical_duration: 8 # time from hospital admit to death (14) - duration of severe infections
        fatality_ratio: 0.02 # fraction of all symptomatic infected individuals who eventually die
        # => our values:
        doubling_rate: 1.15
        incubation_period: 5
        i1_percentage: 0.855
        i2_percentage: 0.12
        i3_percentage: 0.025
        infected_health_care_proportion: 0.05
    simulacovid:
        resources_available_proportion: 0.5
        columns:
            cnes: [
            "country_iso",
            "country_name",
            "state_num_id",
            "state_id",
            "state_name",
            "health_region_id",
            "health_region_name",
            "city_id",
            "city_name",
            "population",
            "last_updated_number_beds",
            "author_number_beds",
            "last_updated_number_ventilators",
            "author_number_ventilators",
            'number_ventilators',
            'number_beds',
            'number_icu_beds'
        ]

impulso:
    contact:
        msg: "Olá Equipe Coronacidades. Vocês podem me ajuda com uma dúvida?"
        phone: "+551633823108"
